moment.locale("es");let vm=new Vue({vuetify:vuetify,el:"#siac-suite-container",data:{barAlert:!1,barTimeout:1e3,barMessage:"",barType:"",loading:!1,join_loading:!1,dialog:!1,dialogDelete:!1,viewDialog:!1,all_announcements:!0,user_id:-1,uid:uid,editedIndex:-1,announcements:[],author:{},editedItem:{},defaultItem:{title:"",content:"",published_at:moment()}},computed:{formTitle:function(){return-1===this.editedIndex?"Crear anuncio":"Editar anuncio"},filterByDate:function(){if(this.all_announcements)return this.announcements.sort((e,t)=>e.published_at<t.published_at?1:-1);var t=this.user_id;return this.announcements.filter(e=>e.user_id==t).sort((e,t)=>e.published_at<t.published_at?1:-1)},announcementBtnTitle:function(){return this.all_announcements?"Mis anuncios":"Todos los anuncios"}},created:function(){this.initialize()},mounted:function(){},methods:{initialize:function(){var e=api_url+"announcements/get";this.$http.get(e).then(e=>{this.announcements=e.body},e=>{})},editItem:function(e){this.editedIndex=this.announcements.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},joinChat:function(e){var t=this;t.join_loading=!0;var n=api_url+"group-chat/join-group",i={group_id:t.author.group_chat,user_id:uid};t.$http.post(n,i).then(e=>{t.join_loading=!1,"success"==e.body.status&&(t.author.user_member=uid)},e=>{})},deleteItem:function(e){this.editedIndex=this.announcements.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm:function(){var e=this.editedItem.announcement_id,t=api_url+"announcements/delete";this.$http.post(t,{announcement_id:e}).then(e=>{"success"==e.body.status&&this.announcements.splice(this.editedIndex,1),this.closeDelete(),activateAlert(e.body.message,e.body.status)},e=>{this.closeDelete()})},closeDelete:function(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},close:function(){this.dialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save:function(){var e,n=this,t=n.editedIndex;-1<n.editedIndex?(e=api_url+"announcements/update",n.$http.post(e,announcement).then(e=>{"success"==e.body.status&&Object.assign(n.announcements[t],n.editedItem),activateAlert(e.body.message,e.body.status)},e=>{})):(e=api_url+"group-chat/create-group",n.$http.post(e,{group_name:n.editedItem.title}).then(e=>{var t;"success"==e.body.status&&(t=e.body.data,e=api_url+"announcements/create",n.editedItem.group_chat=t,n.$http.post(e,n.editedItem).then(e=>{n.editedItem.published_at=moment(),n.editedItem.user_id=e.body.data.user_id,n.editedItem.announcement_id=e.body.data.announcement_id,n.announcements.push(n.editedItem),activateAlert(e.body.message,e.body.status)},e=>{}))})),n.close()},switchAnnouncenments:function(e){this.all_announcements?this.all_announcements=!1:this.all_announcements=!0,this.user_id=e},get_announcement:function(e){var t=this;t.author={};var n=api_url+"announcements/get-author";t.viewDialog=!0,t.editedItem=Object.assign({},e);e={announcement_id:e.announcement_id,group_id:e.group_chat};t.$http.post(n,e).then(e=>{t.author=e.body},e=>{})},fromNow:function(e){return moment(e).fromNow()}}});